# Network Configuration Files

## Configuration File Locations

**RHEL/Fedora:**
*   `/etc/sysconfig/network-scripts/` - Interface configs
*   `/etc/hostname` - System hostname
*   `/etc/hosts` - Local hostname mappings
*   `/etc/resolv.conf` - DNS servers
*   `/etc/nsswitch.conf` - Name resolution order

**Ubuntu:**
*   `/etc/netplan/` - Network configuration (newer)
*   `/etc/network/interfaces` - Network configuration (older)

---

## Network Interface Files

**Location:** `/etc/sysconfig/network-scripts/`

**Naming:** `ifcfg-interface` (e.g., `ifcfg-enp4s0`)

### DHCP Configuration Example

**File:** `/etc/sysconfig/network-scripts/ifcfg-enp4s0`

```bash
DEVICE=enp4s0
TYPE=Ethernet
BOOTPROTO=dhcp
ONBOOT=yes
DEFROUTE=yes
UUID=f16259c2-f350-4d78-a539-604c3f95998c
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
NAME="System enp4s0"
PEERDNS=yes
PEERROUTES=yes
```

**Key settings:**
*   `BOOTPROTO=dhcp` - Get address from DHCP
*   `ONBOOT=yes` - Start at boot
*   `PEERDNS=yes` - Use DNS from DHCP

### Static IP Configuration Example

**File:** `/etc/sysconfig/network-scripts/ifcfg-enp4s1`

```bash
DEVICE=enp4s1
HWADDR=00:1B:21:0A:E8:5E
TYPE=Ethernet
BOOTPROTO=none
ONBOOT=yes
USERCTL=no
IPADDR=192.168.0.140
NETMASK=255.255.255.0
GATEWAY=192.168.0.1
```

**Key settings:**
*   `BOOTPROTO=none` - Static configuration
*   `IPADDR=` - IP address
*   `NETMASK=` - Subnet mask
*   `GATEWAY=` - Default gateway

### Important Variables

| Variable | Purpose | Example |
|----------|---------|---------|
| `DEVICE` | Interface name | enp4s0 |
| `BOOTPROTO` | dhcp/none/static | dhcp |
| `ONBOOT` | Start at boot | yes |
| `IPADDR` | IP address | 192.168.0.140 |
| `NETMASK` | Subnet mask | 255.255.255.0 |
| `GATEWAY` | Default gateway | 192.168.0.1 |
| `DNS1` | Primary DNS | 8.8.8.8 |
| `DNS2` | Secondary DNS | 8.8.4.4 |
| `PEERDNS` | Use DHCP DNS | yes/no |

---

## /etc/hostname

**Purpose:** Set system hostname

**Format:** Single line with hostname

**Example:**
```
host1.example.com
```

**Check current:**
```bash
hostname
```

**Change temporarily:**
```bash
hostname newhostname
```

**Change permanently:**
```bash
hostnamectl set-hostname newhostname
```

---

## /etc/hosts

**Purpose:** Local hostname-to-IP mapping

**Format:** `IP_address hostname [aliases]`

**Example:**
```
127.0.0.1       localhost localhost.localdomain
::1             localhost localhost.localdomain
192.168.0.201   node1.example.com node1 joe
192.168.0.202   node2.example.com node2 sally
```

**Use cases:**
*   Local network without DNS
*   Quick hostname aliases
*   Override DNS for testing

**Example usage:**
```bash
ping joe  # Pings 192.168.0.201
ssh sally # SSHs to 192.168.0.202
```

---

## /etc/resolv.conf

**Purpose:** DNS server configuration

**Managed by:** NetworkManager (don't edit directly!)

**Example:**
```
# Generated by NetworkManager
nameserver 192.168.0.2
nameserver 192.168.0.3
```

**Settings:**
*   `nameserver` - DNS server IP (up to 3)
*   `search` - Domain search list

**Search domains example:**
```
search example.com example.org example.net
```

**How search works:**
*   Type: `ping host1`
*   Tries: `host1.example.com`
*   Then: `host1.example.org`
*   Then: `host1.example.net`

---

## /etc/nsswitch.conf

**Purpose:** Name resolution order

**Managed by:** `authselect` (don't edit directly!)

**Edit instead:** `/etc/authselect/user-nsswitch.conf`

**Apply changes:**
```bash
authselect apply-changes
```

**Hosts entry:**
```
hosts: files dns myhostname
```

**Resolution order:**
1. `files` - Check `/etc/hosts`
2. `dns` - Query DNS servers
3. `myhostname` - Return local hostname

**Other options:**
*   `nis` - Network Information Service
*   `nisplus` - NIS+
*   `ldap` - LDAP directory

---

## /etc/sysconfig/network

**Purpose:** System-wide network settings

**Example:**
```
GATEWAY=192.168.0.1
```

**Note:** Hostname moved to `/etc/hostname` in RHEL 7+

---

## Alias Interface Files (RHEL 6)

**File:** `/etc/sysconfig/network-scripts/ifcfg-eth0:0`

```bash
DEVICE=eth0:0
ONPARENT=yes
IPADDR=192.168.0.141
NETMASK=255.255.255.0
```

**Newer method (RHEL 7+):**

Add to main ifcfg file:
```bash
IPADDR=192.168.0.187
PREFIX=24
IPADDR1=192.168.99.1
PREFIX1=24
```

---

## Custom Route Files

**File:** `/etc/sysconfig/network-scripts/route-interface`

**Example:** `route-eth0`

```bash
ADDRESS0=192.168.99.0
NETMASK0=255.255.255.0
GATEWAY0=192.168.0.5
```

**Multiple routes:**
```bash
ADDRESS0=192.168.99.0
NETMASK0=255.255.255.0
GATEWAY0=192.168.0.5

ADDRESS1=10.0.0.0
NETMASK1=255.0.0.0
GATEWAY1=192.168.0.10
```

---

## Testing Name Resolution

**Check DNS only:**
```bash
host redhat.com
dig redhat.com
```

**Check all sources (hosts + DNS):**
```bash
getent hosts node1
```

**Example:**
```bash
$ getent hosts node1
192.168.0.201   node1

$ host redhat.com
redhat.com has address 209.132.183.105
```

---

## Review Questions

1. Where are network interface files stored in RHEL?

2. What does BOOTPROTO=dhcp mean?

3. What file contains the system hostname?

4. What is /etc/hosts used for?

5. True or False: You should edit /etc/resolv.conf directly.

6. What command checks all name resolution sources?

7. How do you create an alias in RHEL 7+?

8. Where are custom routes defined?

---

## Quick Reference

```
Configuration Files:
├── /etc/sysconfig/network-scripts/ifcfg-* → Interfaces
├── /etc/hostname                          → Hostname
├── /etc/hosts                             → Local mappings
├── /etc/resolv.conf                       → DNS (auto-generated)
└── /etc/nsswitch.conf                     → Resolution order

Interface File (DHCP):
├── DEVICE=enp4s0
├── BOOTPROTO=dhcp
├── ONBOOT=yes
└── PEERDNS=yes

Interface File (Static):
├── DEVICE=enp4s0
├── BOOTPROTO=none
├── IPADDR=192.168.0.140
├── NETMASK=255.255.255.0
└── GATEWAY=192.168.0.1

Hostname:
├── /etc/hostname              → Permanent
├── hostname                   → View current
└── hostnamectl set-hostname   → Change

DNS Testing:
├── host domain.com    → DNS only
├── dig domain.com     → DNS detailed
└── getent hosts name  → All sources

Aliases (RHEL 7+):
├── IPADDR=192.168.0.187
├── PREFIX=24
├── IPADDR1=192.168.99.1
└── PREFIX1=24

Custom Routes:
File: route-interface
├── ADDRESS0=192.168.99.0
├── NETMASK0=255.255.255.0
└── GATEWAY0=192.168.0.5
```
